### Агрегатные функции
```sql
SELECT
    --Рассчитайте общий доход от всех операций.
    sum(quantity * price) AS total_sum
    --Найдите средний доход с одной сделки.
    ,avg(quantity * price) AS sum_average
    --Определите общее количество проданной продукции.
    ,sum(quantity) AS sum_quantity
    --Подсчитайте количество уникальных пользователей, совершивших покупку.
    ,uniq(user_id) AS users_amount
FROM `default`.transactions;
```

### Функции для работы с типами данных
```sql
SELECT
    --Преобразуйте `transaction_date` в строку формата `YYYY-MM-DD`.
    toString(transaction_date)
    --Извлеките год и месяц из `transaction_date`.
    ,toYear(transaction_date)
    ,toMonth(transaction_date)
    --Округлите `price` до ближайшего целого числа.
    ,round(price)
    --Преобразуйте `transaction_id` в строку.
    ,CAST(transaction_id AS String)
FROM `default`.transactions;
```

### User-Defined Functions (UDFs)
#### Создайте простую UDF для расчета общей стоимости транзакции.
```sql
CREATE FUNCTION transaction_sum AS (quantity, price) -> quantity * price;
```

#### Используйте созданную UDF для расчета общей цены для каждой транзакции.
```sql
SELECT
    transaction_id
    ,transaction_sum(quantity, price)
FROM default.transactions
LIMIT 10;
```

#### Создайте UDF для классификации транзакций на «высокоценные» и «малоценные» на основе порогового значения (например, 100).
```sql
CREATE FUNCTION transaction_highly_valuable AS (quantity, price) -> transaction_sum(quantity, price) > 100;
```

#### Примените UDF для категоризации каждой транзакции.
```sql
SELECT
    transaction_id
    ,transaction_highly_valuable(quantity, price)
FROM default.transactions
LIMIT 10;
```
