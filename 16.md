### Разверните инструмент для переливки данных (например, Airflow или Airbyte).
развёртывание `Airbyte` на WSL под управлением `Ubuntu 24.04.3 LTS (Noble Numbat)` по инструкции 
https://docs.airbyte.com/platform/using-airbyte/getting-started/oss-quickstart#for-linux

```bash
apt install -y curl docker.io
```
```bash
curl -LsfS https://get.airbyte.com | bash -
```
```bash
abctl local install --insecure-cookies
```

### Разверните ClickHouse.
В качестве приёмника данных используется кластер `clickhouse`, развёрнутый в рамках предыдущих домашних заданий.

### Выберите любой источник данных (API, сервис, БД и пр.).
В качестве источника выступает имеющийся инстанс СУБД `PostgreSQL 17`.
#### Подготовка источника:
изменение параметра `wal_level`
```
wal_level=logical
```
перезапуск СУБД
```bash
sudo systemctl restart postgresql@17-main.service
```
создание пользователя и назначение ему прав на объекты в базе данных
```sql
CREATE USER airbyte WITH REPLICATION PASSWORD 'airbyte';
GRANT SELECT ON ALL TABLES IN SCHEMA orders TO airbyte;
GRANT SELECT ON ALL TABLES IN SCHEMA parts TO airbyte;
GRANT SELECT ON ALL TABLES IN SCHEMA vehicle TO airbyte;
```
создание слота и публикации для логической репликации
```sql
SELECT pg_create_logical_replication_slot('airbyte', 'pgoutput');

CREATE PUBLICATION airbyte_pub FOR TABLES IN SCHEMA vehicle;
ALTER PUBLICATION airbyte_pub ADD TABLES IN SCHEMA orders;
ALTER PUBLICATION airbyte_pub ADD TABLES IN SCHEMA parts;
```
установка `REPLICA IDENTITY` таблицам
```sql
DO $f$
DECLARE
    r record;
BEGIN
    FOR r IN 
		SELECT
			c.relnamespace::regnamespace::text AS table_schema
			,c.relname AS table_name
		FROM pg_catalog.pg_class c
		WHERE c.relkind = 'r'
			AND c.relnamespace::regnamespace::text IN ('orders','parts','vehicle')
    LOOP
		EXECUTE format('ALTER TABLE %I.%I REPLICA IDENTITY DEFAULT;', r.table_schema, r.table_name);
    END LOOP;
END $f$;
```

### Настройте подключение инструмента к ClickHouse.
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-clickhouse.png?raw=true)

### Постройте пайплайн для переливки данных в ClickHouse с возможностью регулярного или одноразового выполнения.
настройка источника
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-source2.png?raw=true)
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-source.png?raw=true)

настройка приёмника
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-clickhouse.png?raw=true)

настройка процесса:
схема таблиц
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-connection-schema.png?raw=true)
состояние синхронизации
![Screeenshot](https://github.com/s-kononenko/otus-click-hw/blob/main/images/16-connection-sync.png?raw=true)
